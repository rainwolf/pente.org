
delete from dsg_player_game
where game = 0
and pid in (
22000000001957,
22000000003599,
22000000003212,
22000000003946,
22000000003382,
22000000003008,
22000000004092,
22000000002460,
22000000003973,
22000000003038,
22000000004038,
22000000003532,
22000000003181,
22000000003308,
22000000001808,
22000000002240,
22000000003744,
22000000003287,
22000000002922,
22000000001991,
22000000002753,
22000000003322,
22000000003390,
22000000002316,
22000000003866,
22000000003811,
22000000001873,
22000000003391,
22000000001953,
22000000002490,
22000000002258,
22000000002952,
22000000003010,
22000000002789,
22000000003566,
22000000002101,
22000000002047,
22000000003153,
22000000003824,
22000000003474,
22000000001936,
22000000003690,
22000000002472,
22000000002953,
22000000002902,
22000000002998,
22000000002438,
22000000003372,
22000000002273,
22000000003204,
22000000002870,
22000000003869,
22000000003416,
22000000003963,
22000000002751,
22000000002488,
22000000003392,
22000000004039,
22000000003778,
22000000002917,
22000000002368,
22000000002576,
22000000002749,
22000000003006,
22000000003256,
22000000001867,
22000000002769,
22000000001796,
22000000002884,
22000000002875,
22000000002496,
22000000002344,
22000000001862,
22000000001956,
22000000003076,
22000000003874,
22000000003875,
22000000002109,
22000000003651,
22000000003299,
22000000001865,
22000000003015,
22000000002766);

alter table dsg_player_game
modify rating decimal(14, 9) not null;

update dsg_player_game
set rating = rating + 111.5376149
where game = 0
and (wins + losses) >= 20;

update dsg_player_game
set rating = rating + (wins + losses) * 12.53152765
where game = 0
and (wins + losses) < 20
and !(rating = 1800 and losses = 0)
and !(rating = 1400 and wins = 0)
and !(rating = 1600 and wins = losses);